Publicado em 7 de janeiro

• Editado em 13 de janeiro

Framework de Estratégia Quantitativa Multi-Moeda em Python: Conceitos de Design e Detalhes de Implementação

Introdução

Recentemente, usuários deixaram comentários no artigo do Professor Xiaocao "Como Construir Rapidamente Estratégias Universais de Negociação Multi-Moeda após a Atualização do FMZ" solicitando uma versão de implementação em Python desse framework estratégico. Para atender às necessidades dos desenvolvedores Python, este artigo irá se basear nos conceitos originais da Professora Xiaocao e fornecer explicações detalhadas de como construir um framework universal de negociação quantitativa multi-moeda, combinado com o ambiente de simulação de negociação Binance.
Esse framework apresenta:

Inicialização da Estratégia

Na fase de inicialização da estratégia, primeiro definimos as variáveis globais SYMBOLS, QUOTO e INTERVALO, que representam moedas-alvo de negociação, moeda base e tempo de intervalo. A variável Info armazena todos os dados essenciais necessários durante a execução da estratégia. Depois, através da função InitInfo, inicializamos esses dados, incluindo informações da conta, gerenciamento de tempo, dados de mercado para cada moeda de negociação, informações de ordens, informações de posição, etc. Essas etapas de inicialização garantem que a estratégia tenha estruturas de dados claras e estados iniciais durante a execução, estabelecendo as bases para a execução subsequente da estratégia.

Obtendo Informações de Precisão

Essa etapa garante que as moedas que manuseamos estejam em conformidade com os padrões de câmbio em termos de preço, quantidade de precisão e valores dos pedidos. Pares de negociação diferentes (como BTC/USD ou ETH/USDT) têm precisão mínima diferente para preço e quantidade, então precisamos obter informações de precisão da API da bolsa para evitar ordens não conformes. Por exemplo, ETH/USDT pode permitir duas casas decimais, mas BTC/USDT pode permitir oito casas decimais.

Propósito:

Função GetPrecision:

Atualização dos Dados de Mercado

Obtenha dados atuais de mercado por meio da interface da API, como preço mais recente, melhor oferta, melhor venda, profundidade do livro de pedidos, etc. Essas informações são cruciais para decisões futuras de negociação. Dependendo das diferentes estratégias, esses dados podem ser baseados em velas (dados OHLC) ou em dados de negociação tick a tick.

Propósito:

1. Obter Dados de Mercado:

Use troca. GetTicker para obter informações de mercado em tempo real para todos os pares de negociação. A variável de dados armazena todas as informações do par de negociação.

2. Tratamento de erros:

Se os dados de mercado não puderem ser obtidos com sucesso, o programa usa a função Log para registrar logs e gerar informações de erro retornadas pelo GetLastError.

3、Tempo de atualização:

Use o time.time para registrar o carimbo de data atual, usado para marcar o horário das atualizações dos dados de mercado.

4、Filtragem de dados:

Extraia nomes das moedas de negociação a partir dos dados de mercado.
Filtre pares de negociação não qualificados, como pares não estabelecidos em moeda base ou aqueles que não são contratos perpétuos.

5. Atualizar Dados de Mercado:

Para moedas de negociação qualificadas, atualize o preço de compra, preço de venda e último preço negociado.

Por meio dessa função, o sistema pode obter e atualizar as informações de mercado mais recentes para moedas-alvo em tempo real.

Atualização das Informações de Conta e Cargo

Obtenha o saldo da conta e o status da posição atual (moedas compradas, quantidades, preços de custo, etc.) por meio da API. Essa etapa é crucial para avaliar os fundos disponíveis, calcular riscos e gerenciar posições. Por exemplo, as posições atuais determinam se se deve adicionar ou reduzir posições.

Propósito:

1、Função Atualizar Conta:

Calcule o Lucro: Calcule o lucro e a taxa de lucro com base no saldo atual e no saldo inicial.
2、Função AtualizarPosição:

Obtenha informações de posição: Central. GetPositions() para obter o status atual da vaga.

Atualize Posições: Atualize as informações de posição da moeda alvo com base nos dados de posição obtidos (como montante, hold_price, unrealised_profit, etc.).

Calcule a alavancagem: Calcule a alavancagem geral com base nos valores atuais de posições longas e curtas e no saldo das margens.
Por meio dessas duas funções, a estratégia pode monitorar continuamente o status da conta e as mudanças de posição, fornecendo suporte de dados em tempo real para decisões de negociação subsequentes.

Execução da Ordem

Execute operações de compra/venda baseadas na lógica da estratégia. Podem ser ordens de mercado, ordens limitadas ou outros tipos de ordens. Essa etapa envolve interagir com APIs de exchange para enviar pedidos de compra ou venda. A execução bem-sucedida da ordem afeta o saldo da conta e as posições.

Propósito:

Exibição de status

Exibição em tempo real do status da estratégia em execução, incluindo saldo da conta, posições atuais, status da execução de operações, preços atuais de mercado, etc. Essa etapa não serve apenas para monitorar o desempenho da estratégia, mas também para facilitar a otimização e depuração da estratégia, entendendo rapidamente o desempenho da estratégia.

Propósito:

Lógica de Negociação

A parte da decisão central de negociação. Com base em dados de mercado, informações da conta e posições, combinados com indicadores técnicos ou modelos quantitativos, decidem se compram, vendem, adicionam posições ou reduzem posições. A lógica de negociação varia de acordo com diferentes estratégias, como estratégias de seguimento de tendência, estratégias de reversão à média ou estratégias de rompimento.

Propósito:

Circuito Principal

O principal ciclo é a parte central do arcabouço estratégico, responsável por garantir que a estratégia funcione de forma contínua e estável no mercado. Ele executará periodicamente várias operações de acordo com intervalos de tempo estabelecidos, como obtenção dos dados de mercado mais recentes, atualização de informações de posição, tomada de decisões de negociação, etc. Por meio do ciclo principal, a estratégia pode responder às mudanças do mercado em tempo real e garantir que cada execução seja baseada nos dados de mercado mais recentes. Normalmente, o loop principal é ativado uma vez a cada novo período de tempo (como a cada minuto, a cada hora ou a cada nova geração de castiçais).

Propósito:

Explicação do Código

1、Função OnTick: Esta função é a tarefa principal executada em cada iteração principal do ciclo. É responsável por atualizar dados de mercado, informações de posição, executar operações de negociação e atualizar o status da estratégia. Todas as operações de negociação e atualização de informações são realizadas nesta função. Se ocorrerem erros durante a execução, eles serão detectados e registrados.
2、Função Principal: A função principal inicializa as informações relevantes, define a base de troca e inicia um ciclo infinito. Em cada iteração do ciclo, o programa verifica se o intervalo de tempo estabelecido já passou. Se sim, a função OnTick é chamada para executar a estratégia. Se o intervalo de tempo não tiver passado, o programa espera e continua em looping, garantindo que a estratégia seja executada de acordo com o intervalo de tempo predeterminado.
3、Controle de Atraso: Após o término de cada iteração do ciclo, o programa pausa por 5 milissegundos para reduzir a carga da CPU. Isso impede que loops de alta frequência causem um consumo excessivo de recursos computacionais.

Lógica de Execução

Resumo

O design dessa estrutura estratégica foca em modularidade e extensibilidade. Cada etapa possui responsabilidades claras, garantindo a robustez da estratégia enquanto facilita a expansão e otimização futuras. Ao utilizar corretamente as funções da API da exchange, as estratégias podem simplificar a execução e melhorar a consistência entre backtesting e negociação ao vivo.
Deve-se notar que este framework de demonstração usa o Binance simulation exchange como exemplo, com o objetivo de fornecer uma estrutura básica de desenvolvimento e execução de estratégias. Em operações reais, ela precisa ser otimizada em combinação com lógica estratégica específica ao vivo, como ajustar dinamicamente parâmetros com base nas condições do mercado, otimizar mecanismos de controle de risco, adicionar tratamento de exceções, etc. Além disso, como diferentes bolsas apresentam diferenças em interfaces de API, regras de negociação, configurações de precisão, estruturas de taxas, etc., nas aplicações reais, são necessárias otimizações e adaptações detalhadas de acordo com os requisitos da exchange alvo para garantir estabilidade e compatibilidade da estratégia. Recomenda-se testar e verificar minuciosamente a confiabilidade e o desempenho da estratégia antes da implantação ao vivo.

Apêndice: Endereço do Framework Multi-Moeda Python

Comentários principais (0)

Os templates permitem responder rapidamente perguntas frequentes ou armazenar trechos para reutilização.

Você tem certeza de que quer esconder esse comentário? Ele ficará oculto no seu post, mas ainda será visível pelo permalink do comentário.

Oculte comentários de crianças também

Confirme

Para ações futuras, você pode considerar bloquear essa pessoa e/ou denunciar abuso